<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Fitness Tracker">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192.png">
    <title>Fitness Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .install-banner {
            background: rgba(255, 255, 255, 0.95);
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 20px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            display: none;
        }

        .install-banner.show {
            display: block;
        }

        .install-banner button {
            margin-top: 10px;
        }

        .date-selector {
            background: white;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .date-selector input[type="date"] {
            padding: 10px 15px;
            border: 2px solid #667eea;
            border-radius: 8px;
            font-size: 1rem;
            outline: none;
            transition: border-color 0.3s;
        }

        .date-selector input[type="date"]:focus {
            border-color: #764ba2;
        }

        .main-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .card {
            background: white;
            border-radius: 16px;
            padding: 25px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 24px rgba(0,0,0,0.15);
        }

        .card h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card h2::before {
            content: '';
            width: 4px;
            height: 24px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 2px;
        }

        .food-search-container {
            position: relative;
            margin-bottom: 15px;
        }

        .food-search-input {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 0.95rem;
            outline: none;
            transition: border-color 0.3s;
        }

        .food-search-input:focus {
            border-color: #667eea;
        }

        .food-search-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 2px solid #667eea;
            border-top: none;
            border-radius: 0 0 8px 8px;
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .food-search-results.show {
            display: block;
        }

        .food-result-item {
            padding: 12px;
            cursor: pointer;
            border-bottom: 1px solid #e0e0e0;
            transition: background 0.2s;
        }

        .food-result-item:hover {
            background: #f8f9fa;
        }

        .food-result-item:last-child {
            border-bottom: none;
        }

        .food-result-name {
            font-weight: 600;
            color: #667eea;
            margin-bottom: 3px;
        }

        .food-result-macros {
            font-size: 0.85rem;
            color: #666;
        }

        .loading-spinner {
            text-align: center;
            padding: 15px;
            color: #667eea;
            font-style: italic;
        }

        .input-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin-bottom: 15px;
        }

        .input-group input,
        .input-group select {
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 0.95rem;
            outline: none;
            transition: border-color 0.3s;
        }

        .input-group input:focus,
        .input-group select:focus {
            border-color: #667eea;
        }

        .macro-display {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 15px;
            display: none;
        }

        .macro-display.show {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
        }

        .macro-item {
            text-align: center;
        }

        .macro-item strong {
            display: block;
            color: #667eea;
            font-size: 1.2rem;
        }

        .macro-item span {
            font-size: 0.85rem;
            color: #666;
        }

        button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            font-weight: 600;
        }

        button:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: scale(0.98);
        }

        .delete-btn {
            background: linear-gradient(135deg, #f093fb, #f5576c);
            padding: 6px 12px;
            font-size: 0.85rem;
        }

        .workout-list,
        .meal-list {
            margin-top: 20px;
        }

        .workout-item,
        .meal-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.3s;
        }

        .workout-item:hover,
        .meal-item:hover {
            background: #e9ecef;
        }

        .workout-item.completed {
            opacity: 0.6;
            text-decoration: line-through;
        }

        .item-details {
            flex: 1;
        }

        .item-details strong {
            color: #667eea;
            display: block;
            margin-bottom: 5px;
            font-size: 1.1rem;
        }

        .item-details span {
            color: #666;
            font-size: 0.9rem;
            display: block;
        }

        .item-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .checkbox {
            width: 24px;
            height: 24px;
            cursor: pointer;
        }

        .stats {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            margin-top: 20px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }

        .stat-item h3 {
            font-size: 2rem;
            margin-bottom: 5px;
        }

        .stat-item p {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meal-section {
            margin-bottom: 25px;
            padding-bottom: 25px;
            border-bottom: 2px solid #e0e0e0;
        }

        .meal-section:last-child {
            border-bottom: none;
        }

        .meal-section h3 {
            color: #764ba2;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .meal-total {
            font-weight: bold;
            color: #667eea;
            margin-top: 10px;
            font-size: 1.1rem;
        }

        .empty-state {
            text-align: center;
            color: #999;
            padding: 30px;
            font-style: italic;
        }

        @media (max-width: 768px) {
            .main-grid {
                grid-template-columns: 1fr;
            }

            header h1 {
                font-size: 2rem;
            }

            .input-group {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="install-banner" id="install-banner">
            <strong>Install Fitness Tracker</strong>
            <p>Add this app to your home screen for quick access</p>
            <button onclick="installApp()">Install App</button>
            <button onclick="hideInstallBanner()" class="delete-btn">Not Now</button>
        </div>

        <header>
            <h1>üí™ Fitness Tracker</h1>
            <p>Track your workouts and nutrition</p>
        </header>

        <div class="date-selector">
            <label for="date-picker"><strong>Select Date:</strong></label>
            <input type="date" id="date-picker">
        </div>

        <div class="main-grid">
            <!-- Workout Section -->
            <div class="card">
                <h2>üèãÔ∏è Workout Plan</h2>

                <div class="input-group">
                    <input type="text" id="exercise-name" placeholder="Exercise name">
                    <input type="number" id="exercise-sets" placeholder="Sets" min="1">
                    <input type="number" id="exercise-reps" placeholder="Reps" min="1">
                    <input type="number" id="exercise-weight" placeholder="Weight (kg)" min="0" step="0.5">
                </div>

                <button onclick="addWorkout()">Add Exercise</button>

                <div class="workout-list" id="workout-list">
                    <div class="empty-state">No exercises added yet</div>
                </div>
            </div>

            <!-- Calorie Tracker Section -->
            <div class="card">
                <h2>üçΩÔ∏è Calorie Tracker</h2>

                <!-- Breakfast -->
                <div class="meal-section">
                    <h3>‚òÄÔ∏è Breakfast</h3>
                    <div class="food-search-container">
                        <input type="text"
                               class="food-search-input"
                               id="breakfast-search"
                               placeholder="Search for food..."
                               autocomplete="off">
                        <div class="food-search-results" id="breakfast-results"></div>
                    </div>
                    <div class="macro-display" id="breakfast-macros"></div>
                    <div class="input-group">
                        <input type="number" id="breakfast-serving" placeholder="Serving size (g)" min="1" value="100">
                    </div>
                    <button onclick="addMeal('breakfast')">Add to Breakfast</button>
                    <div class="meal-list" id="breakfast-list"></div>
                    <div class="meal-total" id="breakfast-total">Total: 0 cal | Protein: 0g</div>
                </div>

                <!-- Lunch -->
                <div class="meal-section">
                    <h3>üåû Lunch</h3>
                    <div class="food-search-container">
                        <input type="text"
                               class="food-search-input"
                               id="lunch-search"
                               placeholder="Search for food..."
                               autocomplete="off">
                        <div class="food-search-results" id="lunch-results"></div>
                    </div>
                    <div class="macro-display" id="lunch-macros"></div>
                    <div class="input-group">
                        <input type="number" id="lunch-serving" placeholder="Serving size (g)" min="1" value="100">
                    </div>
                    <button onclick="addMeal('lunch')">Add to Lunch</button>
                    <div class="meal-list" id="lunch-list"></div>
                    <div class="meal-total" id="lunch-total">Total: 0 cal | Protein: 0g</div>
                </div>

                <!-- Dinner -->
                <div class="meal-section">
                    <h3>üåô Dinner</h3>
                    <div class="food-search-container">
                        <input type="text"
                               class="food-search-input"
                               id="dinner-search"
                               placeholder="Search for food..."
                               autocomplete="off">
                        <div class="food-search-results" id="dinner-results"></div>
                    </div>
                    <div class="macro-display" id="dinner-macros"></div>
                    <div class="input-group">
                        <input type="number" id="dinner-serving" placeholder="Serving size (g)" min="1" value="100">
                    </div>
                    <button onclick="addMeal('dinner')">Add to Dinner</button>
                    <div class="meal-list" id="dinner-list"></div>
                    <div class="meal-total" id="dinner-total">Total: 0 cal | Protein: 0g</div>
                </div>
            </div>
        </div>

        <!-- Daily Stats -->
        <div class="stats">
            <h2>üìä Daily Summary</h2>
            <div class="stats-grid">
                <div class="stat-item">
                    <h3 id="total-exercises">0</h3>
                    <p>Total Exercises</p>
                </div>
                <div class="stat-item">
                    <h3 id="completed-exercises">0</h3>
                    <p>Completed</p>
                </div>
                <div class="stat-item">
                    <h3 id="total-calories">0</h3>
                    <p>Total Calories</p>
                </div>
                <div class="stat-item">
                    <h3 id="total-protein">0g</h3>
                    <p>Total Protein</p>
                </div>
                <div class="stat-item">
                    <h3 id="total-carbs">0g</h3>
                    <p>Total Carbs</p>
                </div>
                <div class="stat-item">
                    <h3 id="total-fat">0g</h3>
                    <p>Total Fat</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentDate = new Date().toISOString().split('T')[0];
        let data = {};
        let selectedFood = {
            breakfast: null,
            lunch: null,
            dinner: null
        };
        let deferredPrompt;

        // Food database (common foods - can be expanded)
        const foodDatabase = [
            { name: "Chicken Breast", calories: 165, protein: 31, carbs: 0, fat: 3.6 },
            { name: "Brown Rice", calories: 112, protein: 2.6, carbs: 24, fat: 0.9 },
            { name: "Broccoli", calories: 34, protein: 2.8, carbs: 7, fat: 0.4 },
            { name: "Salmon", calories: 206, protein: 22, carbs: 0, fat: 13 },
            { name: "Eggs", calories: 155, protein: 13, carbs: 1.1, fat: 11 },
            { name: "Oatmeal", calories: 68, protein: 2.4, carbs: 12, fat: 1.4 },
            { name: "Banana", calories: 89, protein: 1.1, carbs: 23, fat: 0.3 },
            { name: "Apple", calories: 52, protein: 0.3, carbs: 14, fat: 0.2 },
            { name: "Greek Yogurt", calories: 59, protein: 10, carbs: 3.6, fat: 0.4 },
            { name: "Almonds", calories: 579, protein: 21, carbs: 22, fat: 50 },
            { name: "Sweet Potato", calories: 86, protein: 1.6, carbs: 20, fat: 0.1 },
            { name: "Avocado", calories: 160, protein: 2, carbs: 9, fat: 15 },
            { name: "Tuna", calories: 132, protein: 28, carbs: 0, fat: 1.3 },
            { name: "Quinoa", calories: 120, protein: 4.4, carbs: 21, fat: 1.9 },
            { name: "Spinach", calories: 23, protein: 2.9, carbs: 3.6, fat: 0.4 },
            { name: "Whole Wheat Bread", calories: 247, protein: 13, carbs: 41, fat: 3.4 },
            { name: "Peanut Butter", calories: 588, protein: 25, carbs: 20, fat: 50 },
            { name: "Milk", calories: 42, protein: 3.4, carbs: 5, fat: 1 },
            { name: "Beef Steak", calories: 271, protein: 26, carbs: 0, fat: 19 },
            { name: "Pasta", calories: 131, protein: 5, carbs: 25, fat: 1.1 },
            { name: "White Rice", calories: 130, protein: 2.7, carbs: 28, fat: 0.3 },
            { name: "Cheese", calories: 402, protein: 25, carbs: 1.3, fat: 33 },
            { name: "Tomato", calories: 18, protein: 0.9, carbs: 3.9, fat: 0.2 },
            { name: "Carrots", calories: 41, protein: 0.9, carbs: 10, fat: 0.2 },
            { name: "Orange", calories: 47, protein: 0.9, carbs: 12, fat: 0.1 },
            { name: "Strawberries", calories: 32, protein: 0.7, carbs: 8, fat: 0.3 },
            { name: "Blueberries", calories: 57, protein: 0.7, carbs: 14, fat: 0.3 },
            { name: "Turkey Breast", calories: 135, protein: 30, carbs: 0, fat: 0.7 },
            { name: "Cottage Cheese", calories: 98, protein: 11, carbs: 3.4, fat: 4.3 },
            { name: "Walnuts", calories: 654, protein: 15, carbs: 14, fat: 65 },
            { name: "Chickpeas", calories: 164, protein: 8.9, carbs: 27, fat: 2.6 },
            { name: "Lentils", calories: 116, protein: 9, carbs: 20, fat: 0.4 },
            { name: "Tofu", calories: 76, protein: 8, carbs: 1.9, fat: 4.8 },
            { name: "Shrimp", calories: 99, protein: 24, carbs: 0.2, fat: 0.3 },
            { name: "Pork Chop", calories: 231, protein: 25, carbs: 0, fat: 14 },
            { name: "Bacon", calories: 541, protein: 37, carbs: 1.4, fat: 42 },
            { name: "Pizza", calories: 266, protein: 11, carbs: 33, fat: 10 },
            { name: "Hamburger", calories: 295, protein: 17, carbs: 14, fat: 14 },
            { name: "French Fries", calories: 312, protein: 3.4, carbs: 41, fat: 15 },
            { name: "Ice Cream", calories: 207, protein: 3.5, carbs: 24, fat: 11 }
        ];

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('date-picker').value = currentDate;
            loadData();
            renderAll();
            setupFoodSearch();
            setupPWA();
        });

        // PWA Setup
        function setupPWA() {
            // Register service worker
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('sw.js').catch(err => {
                    console.log('Service worker registration failed:', err);
                });
            }

            // Install prompt
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
                document.getElementById('install-banner').classList.add('show');
            });
        }

        function installApp() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('User accepted the install prompt');
                    }
                    deferredPrompt = null;
                    hideInstallBanner();
                });
            }
        }

        function hideInstallBanner() {
            document.getElementById('install-banner').classList.remove('show');
        }

        // Food search setup
        function setupFoodSearch() {
            ['breakfast', 'lunch', 'dinner'].forEach(mealType => {
                const searchInput = document.getElementById(`${mealType}-search`);
                const resultsDiv = document.getElementById(`${mealType}-results`);

                searchInput.addEventListener('input', (e) => {
                    const query = e.target.value.toLowerCase().trim();

                    if (query.length < 2) {
                        resultsDiv.classList.remove('show');
                        return;
                    }

                    const matches = foodDatabase.filter(food =>
                        food.name.toLowerCase().includes(query)
                    ).slice(0, 8);

                    if (matches.length > 0) {
                        resultsDiv.innerHTML = matches.map(food => `
                            <div class="food-result-item" onclick="selectFood('${mealType}', '${food.name}')">
                                <div class="food-result-name">${food.name}</div>
                                <div class="food-result-macros">
                                    ${food.calories} cal | P: ${food.protein}g | C: ${food.carbs}g | F: ${food.fat}g (per 100g)
                                </div>
                            </div>
                        `).join('');
                        resultsDiv.classList.add('show');
                    } else {
                        resultsDiv.innerHTML = '<div class="loading-spinner">No foods found</div>';
                        resultsDiv.classList.add('show');
                    }
                });

                // Close results when clicking outside
                document.addEventListener('click', (e) => {
                    if (!e.target.closest('.food-search-container')) {
                        resultsDiv.classList.remove('show');
                    }
                });
            });
        }

        function selectFood(mealType, foodName) {
            const food = foodDatabase.find(f => f.name === foodName);
            selectedFood[mealType] = food;

            const searchInput = document.getElementById(`${mealType}-search`);
            const resultsDiv = document.getElementById(`${mealType}-results`);
            const macrosDiv = document.getElementById(`${mealType}-macros`);

            searchInput.value = food.name;
            resultsDiv.classList.remove('show');

            // Display macros
            macrosDiv.innerHTML = `
                <div class="macro-item">
                    <strong>${food.calories}</strong>
                    <span>Calories</span>
                </div>
                <div class="macro-item">
                    <strong>${food.protein}g</strong>
                    <span>Protein</span>
                </div>
                <div class="macro-item">
                    <strong>${food.carbs}g</strong>
                    <span>Carbs</span>
                </div>
                <div class="macro-item">
                    <strong>${food.fat}g</strong>
                    <span>Fat</span>
                </div>
            `;
            macrosDiv.classList.add('show');
        }

        // Date picker change
        document.getElementById('date-picker').addEventListener('change', (e) => {
            currentDate = e.target.value;
            renderAll();
        });

        // Load data from localStorage
        function loadData() {
            const saved = localStorage.getItem('fitnessTrackerData');
            if (saved) {
                data = JSON.parse(saved);
            }
        }

        // Save data to localStorage
        function saveData() {
            localStorage.setItem('fitnessTrackerData', JSON.stringify(data));
        }

        // Get or create data for current date
        function getCurrentDateData() {
            if (!data[currentDate]) {
                data[currentDate] = {
                    workouts: [],
                    meals: {
                        breakfast: [],
                        lunch: [],
                        dinner: []
                    }
                };
            }
            return data[currentDate];
        }

        // Add workout
        function addWorkout() {
            const name = document.getElementById('exercise-name').value.trim();
            const sets = document.getElementById('exercise-sets').value;
            const reps = document.getElementById('exercise-reps').value;
            const weight = document.getElementById('exercise-weight').value;

            if (!name || !sets || !reps) {
                alert('Please fill in exercise name, sets, and reps');
                return;
            }

            const dateData = getCurrentDateData();
            dateData.workouts.push({
                id: Date.now(),
                name,
                sets: parseInt(sets),
                reps: parseInt(reps),
                weight: parseFloat(weight) || 0,
                completed: false
            });

            saveData();
            renderWorkouts();
            updateStats();

            // Clear inputs
            document.getElementById('exercise-name').value = '';
            document.getElementById('exercise-sets').value = '';
            document.getElementById('exercise-reps').value = '';
            document.getElementById('exercise-weight').value = '';
        }

        // Toggle workout completion
        function toggleWorkout(id) {
            const dateData = getCurrentDateData();
            const workout = dateData.workouts.find(w => w.id === id);
            if (workout) {
                workout.completed = !workout.completed;
                saveData();
                renderWorkouts();
                updateStats();
            }
        }

        // Delete workout
        function deleteWorkout(id) {
            const dateData = getCurrentDateData();
            dateData.workouts = dateData.workouts.filter(w => w.id !== id);
            saveData();
            renderWorkouts();
            updateStats();
        }

        // Render workouts
        function renderWorkouts() {
            const dateData = getCurrentDateData();
            const list = document.getElementById('workout-list');

            if (dateData.workouts.length === 0) {
                list.innerHTML = '<div class="empty-state">No exercises added yet</div>';
                return;
            }

            list.innerHTML = dateData.workouts.map(workout => `
                <div class="workout-item ${workout.completed ? 'completed' : ''}">
                    <div class="item-details">
                        <strong>${workout.name}</strong>
                        <span>${workout.sets} sets √ó ${workout.reps} reps${workout.weight ? ` @ ${workout.weight}kg` : ''}</span>
                    </div>
                    <div class="item-actions">
                        <input type="checkbox" class="checkbox" ${workout.completed ? 'checked' : ''}
                               onchange="toggleWorkout(${workout.id})">
                        <button class="delete-btn" onclick="deleteWorkout(${workout.id})">Delete</button>
                    </div>
                </div>
            `).join('');
        }

        // Add meal
        function addMeal(mealType) {
            const food = selectedFood[mealType];
            const servingSize = parseFloat(document.getElementById(`${mealType}-serving`).value) || 100;

            if (!food) {
                alert('Please search and select a food item');
                return;
            }

            const multiplier = servingSize / 100;
            const dateData = getCurrentDateData();

            dateData.meals[mealType].push({
                id: Date.now(),
                food: food.name,
                servingSize: servingSize,
                calories: Math.round(food.calories * multiplier),
                protein: Math.round(food.protein * multiplier * 10) / 10,
                carbs: Math.round(food.carbs * multiplier * 10) / 10,
                fat: Math.round(food.fat * multiplier * 10) / 10
            });

            saveData();
            renderMeal(mealType);
            updateStats();

            // Clear inputs
            document.getElementById(`${mealType}-search`).value = '';
            document.getElementById(`${mealType}-serving`).value = '100';
            document.getElementById(`${mealType}-macros`).classList.remove('show');
            selectedFood[mealType] = null;
        }

        // Delete meal item
        function deleteMealItem(mealType, id) {
            const dateData = getCurrentDateData();
            dateData.meals[mealType] = dateData.meals[mealType].filter(m => m.id !== id);
            saveData();
            renderMeal(mealType);
            updateStats();
        }

        // Render meal
        function renderMeal(mealType) {
            const dateData = getCurrentDateData();
            const list = document.getElementById(`${mealType}-list`);
            const meals = dateData.meals[mealType];

            if (meals.length === 0) {
                list.innerHTML = '';
            } else {
                list.innerHTML = meals.map(meal => `
                    <div class="meal-item">
                        <div class="item-details">
                            <strong>${meal.food} (${meal.servingSize}g)</strong>
                            <span>${meal.calories} cal | P: ${meal.protein}g | C: ${meal.carbs}g | F: ${meal.fat}g</span>
                        </div>
                        <div class="item-actions">
                            <button class="delete-btn" onclick="deleteMealItem('${mealType}', ${meal.id})">Delete</button>
                        </div>
                    </div>
                `).join('');
            }

            // Update meal total
            const totalCal = meals.reduce((sum, meal) => sum + meal.calories, 0);
            const totalProtein = meals.reduce((sum, meal) => sum + meal.protein, 0);
            document.getElementById(`${mealType}-total`).textContent =
                `Total: ${totalCal} cal | Protein: ${Math.round(totalProtein * 10) / 10}g`;
        }

        // Render all meals
        function renderMeals() {
            renderMeal('breakfast');
            renderMeal('lunch');
            renderMeal('dinner');
        }

        // Update stats
        function updateStats() {
            const dateData = getCurrentDateData();

            const totalExercises = dateData.workouts.length;
            const completedExercises = dateData.workouts.filter(w => w.completed).length;

            let totalCalories = 0;
            let totalProtein = 0;
            let totalCarbs = 0;
            let totalFat = 0;

            ['breakfast', 'lunch', 'dinner'].forEach(mealType => {
                dateData.meals[mealType].forEach(meal => {
                    totalCalories += meal.calories;
                    totalProtein += meal.protein;
                    totalCarbs += meal.carbs;
                    totalFat += meal.fat;
                });
            });

            document.getElementById('total-exercises').textContent = totalExercises;
            document.getElementById('completed-exercises').textContent = completedExercises;
            document.getElementById('total-calories').textContent = totalCalories;
            document.getElementById('total-protein').textContent = Math.round(totalProtein * 10) / 10 + 'g';
            document.getElementById('total-carbs').textContent = Math.round(totalCarbs * 10) / 10 + 'g';
            document.getElementById('total-fat').textContent = Math.round(totalFat * 10) / 10 + 'g';
        }

        // Render everything
        function renderAll() {
            renderWorkouts();
            renderMeals();
            updateStats();
        }
    </script>
</body>
</html>
